{
  "name": "1688è¶…å¼ºåŒ–å‘é€æŒ‰é’®é«˜äº®-MCPè¿æ¥æµ‹è¯•",
  "description": "é€šè¿‡MCP browser_toolsè¿æ¥åˆ°ç”¨æˆ·æµè§ˆå™¨æ‰§è¡Œè¶…å¼ºåŒ–é«˜äº®è„šæœ¬",
  "version": "1.0.0",
  "preflows": ["1688-login-preflow"],
  "anchor": {
    "hostFilter": "1688.com",
    "selectors": [".userAvatarLogo img"],
    "requireVisible": true,
    "maxWaitMs": 600000,
    "pollIntervalMs": 1500,
    "highlight": true,
    "persistHighlight": true,
    "highlightLabel": "LOGIN_ANCHOR"
  },
  "nodes": [
    { "id": "start", "type": "StartNode", "name": "å¼€å§‹", "next": ["attach"] },
    {
      "id": "attach",
      "type": "AttachSessionNode",
      "name": "ä¼šè¯æ¥åŠ›",
      "config": {},
      "next": ["navigate_to_chat"]
    },
    {
      "id": "navigate_to_chat",
      "type": "NavigationNode",
      "name": "å¯¼èˆªåˆ°1688èŠå¤©é¡µé¢",
      "config": {
        "url": "https://air.1688.com/app/ocms-fusion-components-1688/def_cbu_web_im/index.html",
        "waitUntil": "domcontentloaded",
        "timeout": 30000
      },
      "next": ["wait_chat_load"]
    },
    {
      "id": "wait_chat_load",
      "type": "WaitNode",
      "name": "ç­‰å¾…èŠå¤©é¡µé¢åŠ è½½",
      "config": { "minMs": 3000, "maxMs": 5000 },
      "next": ["execute_ultra_highlight"]
    },
    {
      "id": "execute_ultra_highlight",
      "type": "JavaScriptExecutionNode",
      "name": "æ‰§è¡Œè¶…å¼ºåŒ–é«˜äº®è„šæœ¬",
      "config": {
        "script": "// è¶…å¼ºåŒ–1688å‘é€æŒ‰é’®é«˜äº®è„šæœ¬\nconsole.log('ğŸ¨ å¼€å§‹æ‰§è¡Œè¶…å¼ºåŒ–1688å‘é€æŒ‰é’®é«˜äº®...');\n\n// æ·»åŠ è„‰å†²åŠ¨ç”»CSS\nconst style = document.createElement('style');\nstyle.textContent = `\n@keyframes pulse-glow {\n    0% {\n        transform: scale(1);\n        box-shadow: 0 0 20px rgba(255, 0, 0, 0.8);\n    }\n    50% {\n        transform: scale(1.1);\n        box-shadow: 0 0 40px rgba(255, 0, 0, 1), 0 0 60px rgba(255, 0, 0, 0.6);\n    }\n    100% {\n        transform: scale(1);\n        box-shadow: 0 0 20px rgba(255, 0, 0, 0.8);\n    }\n}\n\n@keyframes pulse-blue {\n    0% {\n        transform: scale(1);\n        box-shadow: 0 0 20px rgba(0, 100, 255, 0.8);\n    }\n    50% {\n        transform: scale(1.1);\n        box-shadow: 0 0 40px rgba(0, 100, 255, 1), 0 0 60px rgba(0, 100, 255, 0.6);\n    }\n    100% {\n        transform: scale(1);\n        box-shadow: 0 0 20px rgba(0, 100, 255, 0.8);\n    }\n}\n\n@keyframes pulse-green {\n    0% {\n        transform: scale(1);\n        box-shadow: 0 0 20px rgba(0, 255, 0, 0.8);\n    }\n    50% {\n        transform: scale(1.05);\n        box-shadow: 0 0 40px rgba(0, 255, 0, 1), 0 0 60px rgba(0, 255, 0, 0.6);\n    }\n    100% {\n        transform: scale(1);\n        box-shadow: 0 0 20px rgba(0, 255, 0, 0.8);\n    }\n}\n\n@keyframes rainbow-border {\n    0% { border-color: red; }\n    25% { border-color: orange; }\n    50% { border-color: yellow; }\n    75% { border-color: green; }\n    100% { border-color: blue; }\n}\n`;\ndocument.head.appendChild(style);\n\n// è¶…å¼ºæ ·å¼é…ç½®\nconst ultraStyles = {\n    sendButton: {\n        border: '8px solid red !important',\n        background: 'rgba(255, 0, 0, 0.7) !important',\n        boxShadow: '0 0 30px rgba(255, 0, 0, 1), inset 0 0 20px rgba(255, 0, 0, 0.5) !important',\n        zIndex: '999999 !important',\n        position: 'relative !important',\n        transform: 'scale(1.05) !important',\n        animation: 'pulse-glow 1.5s infinite !important',\n        borderRadius: '8px !important',\n        outline: '3px solid rgba(255, 255, 255, 0.8) !important',\n        outlineOffset: '3px !important'\n    },\n    inputBox: {\n        border: '6px solid blue !important',\n        background: 'rgba(0, 100, 255, 0.6) !important',\n        boxShadow: '0 0 25px rgba(0, 100, 255, 1), inset 0 0 15px rgba(0, 100, 255, 0.4) !important',\n        zIndex: '999998 !important',\n        position: 'relative !important',\n        transform: 'scale(1.03) !important',\n        animation: 'pulse-blue 1.3s infinite !important',\n        borderRadius: '6px !important',\n        outline: '2px solid rgba(255, 255, 255, 0.7) !important'\n    },\n    container: {\n        border: '4px solid green !important',\n        background: 'rgba(0, 255, 0, 0.4) !important',\n        boxShadow: '0 0 20px rgba(0, 255, 0, 0.8), inset 0 0 10px rgba(0, 255, 0, 0.3) !important',\n        zIndex: '999997 !important',\n        position: 'relative !important',\n        transform: 'scale(1.02) !important',\n        animation: 'pulse-green 1.1s infinite !important',\n        borderRadius: '4px !important',\n        outline: '2px solid rgba(255, 255, 255, 0.6) !important'\n    }\n};\n\nlet highlightedCount = 0;\n\n// æ¸…é™¤ä¹‹å‰çš„é«˜äº®\ndocument.querySelectorAll('[data-ultra-highlight]').forEach(el => {\n    el.removeAttribute('data-ultra-highlight');\n    // é‡ç½®æ ·å¼\n    el.style.cssText = el.getAttribute('data-original-style') || '';\n});\n\nconsole.log('ğŸ§¹ æ¸…ç†å®Œæˆï¼Œå¼€å§‹æ–°çš„é«˜äº®...');\n\n// 1. é«˜äº®æ‰€æœ‰è“è‰²å‘é€æŒ‰é’®ï¼ˆé€šè¿‡å†…è”æ ·å¼ï¼‰\ndocument.querySelectorAll('button[style*=\"background-color\"]').forEach((el, index) => {\n    const style = el.getAttribute('style') || '';\n    if (style.includes('rgb(0, 115, 255)') || style.includes('rgb(0,115,255)') ||\n        style.includes('#0073FF') || style.includes('background-color:rgb(0,115,255)')) {\n\n        // ä¿å­˜åŸå§‹æ ·å¼\n        if (!el.hasAttribute('data-original-style')) {\n            el.setAttribute('data-original-style', el.style.cssText || '');\n        }\n\n        // åº”ç”¨è¶…å¼ºåŒ–æ ·å¼\n        Object.keys(ultraStyles.sendButton).forEach(prop => {\n            el.style[prop] = ultraStyles.sendButton[prop];\n        });\n\n        el.setAttribute('data-ultra-highlight', 'blue-send-' + index);\n        highlightedCount++;\n        console.log('ğŸ“¤ è¶…å¼ºé«˜äº®è“è‰²å‘é€æŒ‰é’®', index + 1, ':', el.textContent.trim().substring(0, 30));\n    }\n});\n\n// 2. é«˜äº®åŒ…å«insightç±»çš„æŒ‰é’®\ndocument.querySelectorAll('button[class*=\"insight\"], button[class*=\"Insight\"]').forEach((el, index) => {\n    if (!el.hasAttribute('data-ultra-highlight')) {\n\n        // ä¿å­˜åŸå§‹æ ·å¼\n        if (!el.hasAttribute('data-original-style')) {\n            el.setAttribute('data-original-style', el.style.cssText || '');\n        }\n\n        // åº”ç”¨è¶…å¼ºåŒ–æ ·å¼\n        Object.keys(ultraStyles.sendButton).forEach(prop => {\n            el.style[prop] = ultraStyles.sendButton[prop];\n        });\n\n        el.setAttribute('data-ultra-highlight', 'insight-' + index);\n        highlightedCount++;\n        console.log('ğŸ“¤ è¶…å¼ºé«˜äº®InsightæŒ‰é’®', index + 1, ':', el.className);\n    }\n});\n\n// 3. é«˜äº®æ‰€æœ‰textareaè¾“å…¥æ¡†\ndocument.querySelectorAll('textarea').forEach((el, index) => {\n    if (!el.hasAttribute('data-ultra-highlight')) {\n\n        // ä¿å­˜åŸå§‹æ ·å¼\n        if (!el.hasAttribute('data-original-style')) {\n            el.setAttribute('data-original-style', el.style.cssText || '');\n        }\n\n        // åº”ç”¨è¾“å…¥æ¡†å¼ºåŒ–æ ·å¼\n        Object.keys(ultraStyles.inputBox).forEach(prop => {\n            el.style[prop] = ultraStyles.inputBox[prop];\n        });\n\n        el.setAttribute('data-ultra-highlight', 'textarea-' + index);\n        highlightedCount++;\n        console.log('ğŸ“ è¶…å¼ºé«˜äº®è¾“å…¥æ¡†', index + 1, ':', el.className || '(æ— ç±»å)');\n    }\n});\n\n// 4. é«˜äº®æ¶ˆæ¯å®¹å™¨\ndocument.querySelectorAll('[class*=\"message\"], [class*=\"chat\"], [class*=\"im\"]').forEach((el, index) => {\n    const rect = el.getBoundingClientRect();\n    if (rect.width > 80 && rect.height > 40) { // åªé«˜äº®æœ‰æ„ä¹‰çš„å®¹å™¨\n\n        if (!el.hasAttribute('data-ultra-highlight')) {\n\n            // ä¿å­˜åŸå§‹æ ·å¼\n            if (!el.hasAttribute('data-original-style')) {\n                el.setAttribute('data-original-style', el.style.cssText || '');\n            }\n\n            // åº”ç”¨å®¹å™¨å¼ºåŒ–æ ·å¼\n            Object.keys(ultraStyles.container).forEach(prop => {\n                el.style[prop] = ultraStyles.container[prop];\n            });\n\n            el.setAttribute('data-ultra-highlight', 'container-' + index);\n            highlightedCount++;\n            console.log('ğŸ’¬ è¶…å¼ºé«˜äº®å®¹å™¨', index + 1, ':', el.className);\n        }\n    }\n});\n\n// 5. æŸ¥æ‰¾åŒ…å«\"å‘é€\"æ–‡æœ¬çš„å…ƒç´ \ndocument.querySelectorAll('button, [role=\"button\"], span, div').forEach((el, index) => {\n    if (!el.hasAttribute('data-ultra-highlight')) {\n        const text = el.textContent.trim();\n        if (text.includes('å‘é€') || text.includes('Send') || text.includes('å‘é€æ¶ˆæ¯')) {\n\n            // ä¿å­˜åŸå§‹æ ·å¼\n            if (!el.hasAttribute('data-original-style')) {\n                el.setAttribute('data-original-style', el.style.cssText || '');\n            }\n\n            // åº”ç”¨å‘é€æŒ‰é’®å¼ºåŒ–æ ·å¼\n            Object.keys(ultraStyles.sendButton).forEach(prop => {\n                el.style[prop] = ultraStyles.sendButton[prop];\n            });\n\n            el.setAttribute('data-ultra-highlight', 'text-send-' + index);\n            highlightedCount++;\n            console.log('ğŸ“¤ è¶…å¼ºé«˜äº®æ–‡æœ¬å‘é€æŒ‰é’®', index + 1, ':', text);\n        }\n    }\n});\n\n// 6. é«˜äº®input[type=\"text\"]å…ƒç´ \ndocument.querySelectorAll('input[type=\"text\"]').forEach((el, index) => {\n    if (!el.hasAttribute('data-ultra-highlight')) {\n\n        // ä¿å­˜åŸå§‹æ ·å¼\n        if (!el.hasAttribute('data-original-style')) {\n            el.setAttribute('data-original-style', el.style.cssText || '');\n        }\n\n        // åº”ç”¨è¾“å…¥æ¡†å¼ºåŒ–æ ·å¼\n        Object.keys(ultraStyles.inputBox).forEach(prop => {\n            el.style[prop] = ultraStyles.inputBox[prop];\n        });\n\n        el.setAttribute('data-ultra-highlight', 'text-input-' + index);\n        highlightedCount++;\n        console.log('ğŸ“ è¶…å¼ºé«˜äº®æ–‡æœ¬è¾“å…¥æ¡†', index + 1);\n    }\n});\n\n// 7. é«˜äº®contenteditableå…ƒç´ \ndocument.querySelectorAll('[contenteditable=\"true\"]').forEach((el, index) => {\n    if (!el.hasAttribute('data-ultra-highlight')) {\n\n        // ä¿å­˜åŸå§‹æ ·å¼\n        if (!el.hasAttribute('data-original-style')) {\n            el.setAttribute('data-original-style', el.style.cssText || '');\n        }\n\n        // åº”ç”¨è¾“å…¥æ¡†å¼ºåŒ–æ ·å¼\n        Object.keys(ultraStyles.inputBox).forEach(prop => {\n            el.style[prop] = ultraStyles.inputBox[prop];\n        });\n\n        el.setAttribute('data-ultra-highlight', 'contenteditable-' + index);\n        highlightedCount++;\n        console.log('ğŸ“ è¶…å¼ºé«˜äº®å¯ç¼–è¾‘å…ƒç´ ', index + 1);\n    }\n});\n\nconsole.log(`ğŸ¯ è¶…å¼ºåŒ–é«˜äº®å®Œæˆï¼æ€»å…±é«˜äº®äº† ${highlightedCount} ä¸ªå…ƒç´ `);\n\n// åˆ›å»ºè¶…å¼ºåŒ–ä¿¡æ¯æç¤ºæ¡†\nconst ultraInfoBox = document.createElement('div');\nultraInfoBox.style.cssText = `\n    position: fixed !important;\n    top: 20px !important;\n    left: 20px !important;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;\n    color: white !important;\n    padding: 20px 25px !important;\n    border-radius: 12px !important;\n    z-index: 999999 !important;\n    font-size: 16px !important;\n    font-weight: bold !important;\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3) !important;\n    border: 2px solid rgba(255, 255, 255, 0.8) !important;\n    max-width: 400px !important;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;\n    animation: slideIn 0.3s ease-out !important;\n`;\n\n// æ·»åŠ æ»‘å…¥åŠ¨ç”»\nconst slideInStyle = document.createElement('style');\nslideInStyle.textContent = `\n@keyframes slideIn {\n    from {\n        transform: translateX(-100%);\n        opacity: 0;\n    }\n    to {\n        transform: translateX(0);\n        opacity: 1;\n    }\n}\n`;\ndocument.head.appendChild(slideInStyle);\n\nultraInfoBox.innerHTML = `\n    <h3 style=\"margin: 0 0 15px 0; text-align: center; font-size: 20px;\">ğŸ¨ 1688è¶…å¼ºåŒ–é«˜äº®å®Œæˆ</h3>\n    <div style=\"margin: 10px 0;\">\n        <p style=\"margin: 5px 0; color: #FFE5B4;\">ğŸ“¤ çº¢è‰²è„‰å†²: å‘é€æŒ‰é’®</p>\n        <p style=\"margin: 5px 0; color: #E3F2FD;\">ğŸ“ è“è‰²è„‰å†²: è¾“å…¥æ¡†</p>\n        <p style=\"margin: 5px 0; color: #E8F5E8;\">ğŸ’¬ ç»¿è‰²è„‰å†²: æ¶ˆæ¯å®¹å™¨</p>\n    </div>\n    <hr style=\"margin: 15px 0; border: 1px solid rgba(255, 255, 255, 0.3);\">\n    <p style=\"margin: 15px 0 5px 0; font-size: 18px; font-weight: bold;\">âœ… æ‰¾åˆ° ${highlightedCount} ä¸ªå…ƒç´ </p>\n    <p style=\"margin: 5px 0 0 0; font-size: 14px; color: #FFE5B4;\">ğŸ”„ 10ç§’åè‡ªåŠ¨æ¶ˆå¤±</p>\n    <button onclick=\"this.parentElement.remove()\" style=\"\n        margin-top: 10px;\n        background: rgba(255, 255, 255, 0.2);\n        border: 1px solid rgba(255, 255, 255, 0.5);\n        border-radius: 6px;\n        padding: 8px 15px;\n        color: white;\n        font-size: 14px;\n        cursor: pointer;\n        width: 100%;\n        font-weight: bold;\n    \">âŒ å…³é—­æç¤º</button>\n`;\n\ndocument.body.appendChild(ultraInfoBox);\n\n// 10ç§’åè‡ªåŠ¨ç§»é™¤æç¤ºæ¡†\nsetTimeout(() => {\n    if (ultraInfoBox && ultraInfoBox.parentNode) {\n        ultraInfoBox.style.opacity = '0';\n        setTimeout(() => {\n            if (ultraInfoBox.parentNode) {\n                ultraInfoBox.parentNode.removeChild(ultraInfoBox);\n            }\n        }, 300);\n    }\n}, 10000);\n\n// åˆ›å»ºè°ƒè¯•ä¿¡æ¯\nconsole.log('\\nğŸ” è°ƒè¯•ä¿¡æ¯:');\nconsole.log('é¡µé¢URL:', window.location.href);\nconsole.log('é¡µé¢æ ‡é¢˜:', document.title);\nconsole.log('æ‰¾åˆ°çš„è“è‰²æŒ‰é’®:', document.querySelectorAll('button[style*=\"background-color\"]').length);\nconsole.log('æ‰¾åˆ°çš„textarea:', document.querySelectorAll('textarea').length);\nconsole.log('æ‰¾åˆ°çš„æ¶ˆæ¯å®¹å™¨:', document.querySelectorAll('[class*=\"message\"], [class*=\"chat\"], [class*=\"im\"]').length);\n\n// è¿”å›è¯¦ç»†ç»“æœ\nreturn {\n    success: true,\n    highlightedCount: highlightedCount,\n    timestamp: new Date().toISOString(),\n    url: window.location.href,\n    title: document.title,\n    elementsFound: {\n        blueButtons: document.querySelectorAll('button[style*=\"background-color\"]').length,\n        textareas: document.querySelectorAll('textarea').length,\n        containers: document.querySelectorAll('[class*=\"message\"], [class*=\"chat\"], [class*=\"im\"]').length,\n        textButtons: document.querySelectorAll('button, span, div').length\n    }\n};",
        "waitForResult": true
      },
      "next": ["save_result"]
    },
    {
      "id": "save_result",
      "type": "ResultSaverNode",
      "name": "ä¿å­˜é«˜äº®ç»“æœ",
      "config": {
        "outputDir": "archive/workflow-records",
        "filenameTemplate": "1688-ultra-highlight-result-{timestamp}.json",
        "includeMetadata": true
      },
      "next": ["end"]
    },
    {
      "id": "end",
      "type": "EndNode",
      "name": "ç»“æŸ",
      "config": { "cleanup": false, "saveLogs": true }
    }
  ],
  "globalConfig": {
    "logLevel": "info",
    "screenshotOnError": true,
    "autoCleanup": false,
    "parallelExecution": false,
    "timeout": 600000
  }
}
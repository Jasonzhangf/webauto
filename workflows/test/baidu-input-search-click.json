{
  "name": "标准点击测试流（Baidu）",
  "description": "打开百度，输入关键词，发起搜索，提取首条结果并使用点击节点进行点击测试。默认关键词：大模型。",
  "version": "1.0.0",
  "parameters": { "keyword": "大模型" },
  "nodes": [
    { "id": "start", "type": "StartNode", "name": "开始", "next": ["init_browser"] },
    {
      "id": "init_browser",
      "type": "BrowserInitNode",
      "name": "初始化浏览器",
      "config": { "headless": false, "viewport": { "width": 1440, "height": 900 }, "timeout": 30000 },
      "next": ["go_baidu"]
    },
    {
      "id": "go_baidu",
      "type": "NavigationNode",
      "name": "打开百度首页",
      "config": { "url": "https://www.baidu.com", "waitUntil": "domcontentloaded", "timeout": 30000 },
      "next": ["wait_home"]
    },
    {
      "id": "wait_home",
      "type": "WaitNode",
      "name": "等待首页渲染",
      "config": { "minMs": 800, "maxMs": 1200 },
      "next": ["probe_search_input"]
    },
    {
      "id": "probe_search_input",
      "type": "JavaScriptExecutionNode",
      "name": "探测可见搜索输入框",
      "config": {
        "script": "var submit=document.querySelector('#su, input[type=submit], .s_btn, button[type=submit]'); var form=(submit&&submit.closest('form'))||document; var list=Array.from(form.querySelectorAll('input')); function vis(e){ var r=e.getBoundingClientRect(); var s=getComputedStyle(e); return r.width>0&&r.height>0&&s.visibility!=='hidden'&&s.display!=='none'&&e.type!=='hidden'; } var cand=list.filter(function(e){ return vis(e)&&(e.type==='text'||e.type==='search'||!e.type); }); var target=cand[0]||document.querySelector('input[name=\"wd\"], #kw'); var sel= target ? (target.id ? '#'+target.id : (target.name ? 'input[name=\"'+target.name.replace(/\\\\/g,'\\\\\\\\').replace(/\"/g,'\\\\\"')+'\"]' : 'input[type=\"text\"]')) : 'input[type=\"text\"]'; return {success: !!target, searchInputSelector: sel};",
        "saveScreenshots": false
      },
      "next": ["input_keyword"]
    },
    {
      "id": "input_keyword",
      "type": "InputNode",
      "name": "输入关键词",
      "config": { "selector": "{{previous.searchInputSelector}}", "text": "{keyword}", "method": "fill", "clear": true, "pressEnter": false, "waitAfter": 300 },
      "next": ["click_search"]
    },
    {
      "id": "click_search",
      "type": "PlaywrightClickNode",
      "name": "点击搜索按钮",
      "config": { "selector": "#su", "waitAfter": 1500, "timeout": 10000, "verifyNavigation": true },
      "next": ["wait_result"]
    },
    {
      "id": "wait_result",
      "type": "WaitNode",
      "name": "等待结果页",
      "config": { "minMs": 1500, "maxMs": 2500 },
      "next": ["batch_click"]
    },
    {
      "id": "batch_click",
      "type": "BatchClickNode",
      "name": "批量点击前五条",
      "config": {
        "containerSelector": "#content_left",
        "itemSelector": "h3 a",
        "count": 5,
        "openInNewTab": true,
        "waitBetweenMs": 600,
        "highlightEach": true,
        "timeout": 15000
      },
      "next": ["hold_for_inspect"]
    },
    {
      "id": "hold_for_inspect",
      "type": "WaitNode",
      "name": "留存窗口供人工检查",
      "config": { "minMs": 600000, "maxMs": 600000 },
      "next": ["save_results"]
    },
    {
      "id": "save_results",
      "type": "ResultSaverNode",
      "name": "保存测试结果",
      "config": { "outputDir": "archive/workflow-records", "filenameTemplate": "standard-click-test-{timestamp}.json", "includeMetadata": true, "mergeData": true },
      "next": ["end"]
    },
    {
      "id": "save_results",
      "type": "ResultSaverNode",
      "name": "保存测试结果",
      "config": { "outputDir": "archive/workflow-records", "filenameTemplate": "standard-click-test-{timestamp}.json", "includeMetadata": true, "mergeData": true },
      "next": ["end"]
    },
    { "id": "end", "type": "EndNode", "name": "结束", "config": { "cleanup": false, "saveLogs": true, "persistSession": true } }
  ],
  "globalConfig": { "logLevel": "info", "timeout": 180000 }
}

{
  "name": "简化搜索测试",
  "description": "只测试搜索结果页面",
  "version": "1.0.0",
  "nodes": [
    { "id": "start", "type": "StartNode", "name": "开始", "next": ["attach"] },
    { "id": "attach", "type": "AttachSessionNode", "name": "会话接力", "config": {}, "next": ["navigate_search"] },
    { 
      "id": "navigate_search",
      "type": "NavigationNode",
      "name": "导航到搜索页",
      "config": {
        "url": "https://s.1688.com/selloffer/offer_search.htm?keywords=%E6%89%8B%E6%9C%BA%E4%BF%9D%E6%8A%A4%E8%86%9C&n=y",
        "waitUntil": "domcontentloaded",
        "timeout": 30000
      },
      "next": ["wait_search"]
    },
    { 
      "id": "wait_search",
      "type": "WaitNode",
      "name": "等待搜索结果加载",
      "config": {
        "minMs": 3000,
        "maxMs": 5000
      },
      "next": ["search_anchor"]
    },
    { 
      "id": "search_anchor",
      "type": "AnchorPointNode",
      "name": "搜索结果锚点",
      "config": { 
        "selectors": [
          ".sm-offer-list",
          "#offer-list", 
          ".offer-list",
          ".sm-offer-item",
          ".offer-item",
          ".sm-offer",
          ".offer-card",
          ".sm-offer-card",
          "[data-spm*='offer']",
          ".sm-offer-wrap",
          "#sm-offer-wrap",
          ".search-result",
          ".search-list"
        ], 
        "requireVisible": true, 
        "highlight": true, 
        "persistHighlight": true,
        "maxWaitMs": 30000,
        "pollIntervalMs": 2000
      },
      "next": ["test_ww_links"]
    },
    {
      "id": "test_ww_links",
      "type": "JavaScriptExecutionNode",
      "name": "测试旺旺链接",
      "config": {
        "script": "(function(){\n  function vis(el){ var s=getComputedStyle(el); if(s.display==='none'||s.visibility==='hidden'||Number(s.opacity)===0) return false; var r=el.getBoundingClientRect(); return r.width>8 && r.height>8; }\n  \n  // 查找所有旺旺链接\n  var allWwLinks = Array.from(document.querySelectorAll('a[href*=\"air.1688.com\"], .ww-link, [class*=\"ww-link\"]'));\n  var visibleWwLinks = allWwLinks.filter(vis);\n  \n  console.log('找到旺旺链接数量:', visibleWwLinks.length);\n  \n  for (var i = 0; i < Math.min(visibleWwLinks.length, 5); i++) {\n    var link = visibleWwLinks[i];\n    console.log('旺旺链接' + (i+1) + ':', link.href, link.className);\n  }\n  \n  return { \n    success: true, \n    totalWwLinks: visibleWwLinks.length,\n    message: '成功找到 ' + visibleWwLinks.length + ' 个旺旺链接'\n  };\n})();",
        "saveScreenshots": true
      },
      "next": ["end"]
    },
    { 
      "id": "end",
      "type": "EndNode",
      "name": "结束",
      "config": {
        "cleanup": false,
        "saveLogs": true
      }
    }
  ],
  "globalConfig": {
    "logLevel": "info",
    "timeout": 180000,
    "keyword": "手机保护膜"
  }
}
{
  "name": "Weibo Homepage Link Capture Workflow",
  "description": "微博主页链接捕获工作流",
  "version": "1.0.0",
  "author": "WebAuto Team",
  "nodes": [
    {
      "id": "start",
      "type": "StartNode",
      "name": "开始节点",
      "position": { "x": 100, "y": 100 },
      "next": ["browser_init"]
    },
    {
      "id": "browser_init",
      "type": "BrowserInitNode",
      "name": "浏览器初始化",
      "config": {
        "headless": true,
        "viewport": { "width": 1920, "height": 1080 },
        "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
      },
      "position": { "x": 300, "y": 100 },
      "next": ["load_cookies"]
    },
    {
      "id": "load_cookies",
      "type": "CookieLoaderNode",
      "name": "加载Cookie",
      "config": {
        "cookiePath": "./cookies/weibo-cookies.json"
      },
      "position": { "x": 500, "y": 100 },
      "next": ["navigate_homepage"]
    },
    {
      "id": "navigate_homepage",
      "type": "NavigationNode",
      "name": "导航到主页",
      "config": {
        "url": "https://weibo.com",
        "waitUntil": "domcontentloaded",
        "timeout": 30000
      },
      "position": { "x": 700, "y": 100 },
      "next": ["verify_login"]
    },
    {
      "id": "verify_login",
      "type": "LoginVerificationNode",
      "name": "验证登录状态",
      "config": {
        "loginSelector": "#app > div.woo-box-flex.woo-box-column.Frame_wrap_3g67Q > div.Frame_top_2ybWw > div > div.Nav_wrap_gHB1a.grayTheme > div > div > div.woo-box-flex.woo-box-alignCenter.woo-box-justifyCenter.Nav_mid_5pisP > div > div.woo-box-flex.woo-tab-nav > a:nth-child(5) > div > div > div > div > img",
        "maxRetries": 3,
        "retryDelay": 2000
      },
      "position": { "x": 900, "y": 100 },
      "next": ["scroll_capture"],
      "error": ["save_results_failed"]
    },
    {
      "id": "scroll_capture",
      "type": "ScrollCaptureNode",
      "name": "滚动捕获链接",
      "config": {
        "target": 50,
        "postContainer": ".vue-recycle-scroller__item-view",
        "maxScrollAttempts": 200,
        "scrollStep": 3,
        "scrollDelay": 1000,
        "noNewLinksLimit": 5,
        "linkPattern": "weibo\\.com\\/\\d+\\/[A-Za-z0-9_\\-]+"
      },
      "position": { "x": 1100, "y": 100 },
      "next": ["save_results"]
    },
    {
      "id": "save_results",
      "type": "ResultSaverNode",
      "name": "保存结果",
      "config": {
        "outputDir": "~/.webauto/weibo",
        "filenameTemplate": "weibo-links-homepage-{timestamp}.json",
        "includeMetadata": true
      },
      "position": { "x": 1300, "y": 100 },
      "next": ["end"]
    },
    {
      "id": "save_results_failed",
      "type": "ResultSaverNode",
      "name": "保存失败结果",
      "config": {
        "outputDir": "~/.webauto/weibo",
        "filenameTemplate": "weibo-links-homepage-{timestamp}-failed.json",
        "includeMetadata": true
      },
      "position": { "x": 900, "y": 200 },
      "next": ["end"]
    },
    {
      "id": "end",
      "type": "EndNode",
      "name": "结束节点",
      "config": {
        "cleanup": true,
        "saveLogs": true
      },
      "position": { "x": 1500, "y": 100 }
    }
  ],
  "globalConfig": {
    "logLevel": "info",
    "screenshotOnError": true,
    "autoCleanup": true,
    "parallelExecution": false,
    "timeout": 300000
  },
  "variables": {
    "capturedLinks": [],
    "scrollCount": 0,
    "noNewLinksCount": 0,
    "startTime": null,
    "endTime": null
  }
}
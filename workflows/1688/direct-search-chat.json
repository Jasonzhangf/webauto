{
  "name": "直接搜索聊天工作流",
  "description": "利用现有会话直接执行搜索和聊天",
  "version": "1.0.0",
  "nodes": [
    {
      "id": "start",
      "type": "StartNode",
      "next": ["attach_session"]
    },
    {
      "id": "attach_session",
      "type": "AttachHostPageNode",
      "config": {
        "sessionId": "sess-1761198807236-950071",
        "timeout": 10000
      },
      "next": ["navigate_search"]
    },
    {
      "id": "navigate_search",
      "type": "NavigationNode",
      "config": {
        "hostFilter": "1688.com",
        "url": "https://s.1688.com/sell/search.htm?keywords=冲锋衣",
        "waitUntil": "networkidle",
        "timeout": 15000
      },
      "next": ["search_results_anchor"]
    },
    {
      "id": "search_results_anchor",
      "type": "AnchorPointNode",
      "config": {
        "hostFilter": "1688.com",
        "selectors": [".sm-offer-card", ".offer-card", ".product-card", ".sm-offer-item"],
        "requireVisible": true,
        "maxWaitMs": 15000,
        "pollIntervalMs": 1000,
        "highlight": true,
        "persistHighlight": true,
        "highlightLabel": "SEARCH_RESULTS",
        "highlightColor": "#007AFF"
      },
      "next": ["find_second_ww"]
    },
    {
      "id": "find_second_ww",
      "type": "JavaScriptExecutionNode",
      "config": {
        "script": "// 查找第二个旺旺链接并点击\nconst cards = document.querySelectorAll('.sm-offer-card, .offer-card, .product-card, .sm-offer-item');\nconsole.log('找到商品卡片数量:', cards.length);\n\nif (cards.length >= 2) {\n  const secondCard = cards[1];\n  const wwLink = secondCard.querySelector('a[href*=\"air.1688.com\"], .ww-link, .wangwang-link, [data-trace=\"ww\"]');\n  \n  if (wwLink) {\n    console.log('找到第二个旺旺链接:', wwLink.href);\n    \n    // 高亮第二个旺旺链接\n    wwLink.style.setProperty('outline', '3px solid #34c759', 'important');\n    wwLink.style.setProperty('background', 'rgba(52, 199, 89, 0.2)', 'important');\n    \n    // 点击旺旺链接\n    wwLink.click();\n    \n    return { \n      found: true, \n      clicked: true,\n      href: wwLink.href\n    };\n  } else {\n    console.log('第二个商品卡片中没有找到旺旺链接');\n  }\n} else {\n  console.log('商品卡片数量不足2个，当前数量:', cards.length);\n}\n\nreturn { found: false, clicked: false };"
      },
      "next": ["wait_for_chat"]
    },
    {
      "id": "wait_for_chat",
      "type": "WaitNode",
      "config": {
        "duration": 3000
      },
      "next": ["chat_anchor"]
    },
    {
      "id": "chat_anchor",
      "type": "AnchorPointNode",
      "config": {
        "hostFilter": "air.1688.com",
        "selectors": [".im-chat-input", ".chat-input", "textarea", "[contenteditable=true]", ".chat-textarea"],
        "requireVisible": true,
        "maxWaitMs": 15000,
        "pollIntervalMs": 1000,
        "highlight": true,
        "persistHighlight": true,
        "highlightLabel": "CHAT_INPUT",
        "highlightColor": "#007AFF"
      },
      "next": ["send_message"]
    },
    {
      "id": "send_message",
      "type": "ChatComposeNode",
      "config": {
        "hostFilter": "air.1688.com",
        "message": "你好",
        "highlight": true,
        "highlightMs": 3000,
        "sendHighlightColor": "#34c759",
        "sendHighlightLabel": "SEND",
        "persistSendHighlight": false,
        "send": true,
        "stabilizeMs": 1000
      },
      "next": ["wait_sent"]
    },
    {
      "id": "wait_sent",
      "type": "WaitNode",
      "config": {
        "duration": 2000
      },
      "next": ["close_tab"]
    },
    {
      "id": "close_tab",
      "type": "JavaScriptExecutionNode",
      "config": {
        "script": "window.close();"
      },
      "next": ["end"]
    },
    {
      "id": "end",
      "type": "EndNode",
      "config": {
        "cleanupHighlights": true,
        "persistSession": false
      }
    }
  ]
}
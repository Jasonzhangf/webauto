{
  "name": "1688å•†å®¶é€‰æ‹©å™¨é«˜äº®éªŒè¯",
  "description": "éªŒè¯å•†å®¶åˆ—è¡¨å®¹å™¨å’Œæ—ºæ—ºé“¾æ¥é€‰æ‹©å™¨çš„æ­£ç¡®æ€§ï¼Œé€šè¿‡é«˜äº®æ˜¾ç¤ºç¡®è®¤å…ƒç´ é€‰æ‹©",
  "version": "1.0.0",
  "preflows": ["1688-login-preflow"],
  "nodes": [
    { "id": "start", "type": "StartNode", "name": "å¼€å§‹", "next": ["attach"] },
    {
      "id": "attach",
      "type": "AttachSessionNode",
      "name": "ä¼šè¯æ¥åŠ›",
      "config": {},
      "next": ["navigate_search"]
    },
    {
      "id": "navigate_search",
      "type": "NavigationNode",
      "name": "å¯¼èˆªåˆ°æœç´¢ç»“æœé¡µ",
      "config": {
        "url": "https://s.1688.com/selloffer/offer_search.htm?keywords=%B7%FE%D7%B0",
        "waitUntil": "domcontentloaded",
        "timeout": 30000
      },
      "next": ["wait_search"]
    },
    {
      "id": "wait_search",
      "type": "WaitNode",
      "name": "ç­‰å¾…æœç´¢ç»“æœåŠ è½½",
      "config": { "minMs": 3000, "maxMs": 5000 },
      "next": ["highlight_merchants"]
    },
    {
      "id": "highlight_merchants",
      "type": "PageSnapshotNode",
      "name": "é«˜äº®å•†å®¶å®¹å™¨éªŒè¯",
      "config": {
        "script": "console.log('ğŸ” å¼€å§‹é«˜äº®å•†å®¶å®¹å™¨éªŒè¯...'); const merchantSelectors = ['.sm-offer-item', '.offer-item', '.sm-offer', '[class*=offer]']; const results = []; merchantSelectors.forEach(selector => { const elements = document.querySelectorAll(selector); if (elements.length > 0) { console.log(`âœ… æ‰¾åˆ°é€‰æ‹©å™¨ ${selector}: ${elements.length} ä¸ªå…ƒç´ `); elements.forEach((el, index) => { if (index < 5) { el.style.border = '3px solid red'; el.style.backgroundColor = 'rgba(255, 255, 0, 0.3)'; el.style.zIndex = '9999'; const title = el.querySelector('h4, [class*=title], a[title]'); const link = el.querySelector('a[href*=\"1688.com\"]'); const contact = el.querySelector('[class*=contact], [class*=chat], [class*=im], [class*=æ—ºæ—º], .sm-im'); console.log(`  å•†å®¶ ${index + 1}: æ ‡é¢˜=${title ? title.textContent.trim().substring(0, 30) : 'æœªæ‰¾åˆ°'}, è”ç³»æ–¹å¼=${contact ? 'æ‰¾åˆ°' : 'æœªæ‰¾åˆ°'}`); } }); results.push({ selector: selector, count: elements.length, highlighted: Math.min(5, elements.length), status: 'success' }); } else { console.log(`âŒ é€‰æ‹©å™¨ ${selector}: æœªæ‰¾åˆ°å…ƒç´ `); results.push({ selector: selector, count: 0, highlighted: 0, status: 'failed' }); } }); console.log('å•†å®¶å®¹å™¨é«˜äº®å®Œæˆï¼Œ5ç§’åç§»é™¤é«˜äº®'); setTimeout(() => { document.querySelectorAll('[style*=\"border: 3px solid red\"]').forEach(el => { el.style.border = ''; el.style.backgroundColor = ''; el.style.zIndex = ''; }); }, 5000); return { success: true, type: 'merchant_highlight', results: results, timestamp: new Date().toISOString() };",
        "saveScreenshots": true
      },
      "next": ["highlight_contacts"]
    },
    {
      "id": "highlight_contacts",
      "type": "PageSnapshotNode",
      "name": "é«˜äº®è”ç³»æ–¹å¼éªŒè¯",
      "config": {
        "script": "console.log('ğŸ“ å¼€å§‹é«˜äº®è”ç³»æ–¹å¼éªŒè¯...'); const contactSelectors = ['[class*=contact]', '[class*=chat]', '[class*=im]', '[class*=æ—ºæ—º]', '.sm-im', '.s-im']; const results = []; let totalContacts = 0; contactSelectors.forEach(selector => { const elements = document.querySelectorAll(selector); if (elements.length > 0) { console.log(`âœ… æ‰¾åˆ°è”ç³»æ–¹å¼é€‰æ‹©å™¨ ${selector}: ${elements.length} ä¸ªå…ƒç´ `); elements.forEach((el, index) => { if (index < 10) { el.style.border = '3px solid blue'; el.style.backgroundColor = 'rgba(0, 255, 255, 0.3)'; el.style.zIndex = '9999'; const merchantItem = el.closest('.sm-offer-item, .offer-item, .sm-offer, [class*=offer]'); const merchantTitle = merchantItem ? merchantItem.querySelector('h4, [class*=title], a[title]') : null; console.log(`  è”ç³»æ–¹å¼ ${index + 1}: æ‰€å±å•†å®¶=${merchantTitle ? merchantTitle.textContent.trim().substring(0, 20) : 'æœªæ‰¾åˆ°å•†å®¶'}, å…ƒç´ æ–‡æœ¬=${el.textContent.trim().substring(0, 20)}`); } }); results.push({ selector: selector, count: elements.length, highlighted: Math.min(10, elements.length), status: 'success' }); totalContacts += elements.length; } else { console.log(`âŒ è”ç³»æ–¹å¼é€‰æ‹©å™¨ ${selector}: æœªæ‰¾åˆ°å…ƒç´ `); results.push({ selector: selector, count: 0, highlighted: 0, status: 'failed' }); } }); console.log('è”ç³»æ–¹å¼é«˜äº®å®Œæˆï¼Œ5ç§’åç§»é™¤é«˜äº®'); setTimeout(() => { document.querySelectorAll('[style*=\"border: 3px solid blue\"]').forEach(el => { el.style.border = ''; el.style.backgroundColor = ''; el.style.zIndex = ''; }); }, 5000); return { success: true, type: 'contact_highlight', results: results, totalContacts: totalContacts, timestamp: new Date().toISOString() };",
        "saveScreenshots": true
      },
      "next": ["extract_sample_merchants"]
    },
    {
      "id": "extract_sample_merchants",
      "type": "PageSnapshotNode",
      "name": "æå–æ ·æœ¬å•†å®¶æ•°æ®",
      "config": {
        "script": "console.log('ğŸ“Š æå–æ ·æœ¬å•†å®¶æ•°æ®è¿›è¡ŒéªŒè¯...'); const merchants = []; const offerItems = document.querySelectorAll('.sm-offer-item, .offer-item, .sm-offer, [class*=offer]'); console.log(`æ‰¾åˆ° ${offerItems.length} ä¸ªå•†å®¶å®¹å™¨`); for (let i = 0; i < Math.min(5, offerItems.length); i++) { const item = offerItems[i]; const title = item.querySelector('h4, [class*=title], a[title]'); const link = item.querySelector('a[href*=\"1688.com\"]'); const price = item.querySelector('[class*=price], [data-price]'); const image = item.querySelector('img[src]'); const contactButton = item.querySelector('[class*=contact], [class*=chat], [class*=im], [class*=æ—ºæ—º], .sm-im, .s-im'); const merchantName = item.querySelector('[class*=company], [class*=name], [class*=shop]'); const merchantLink = link ? link.href : null; let merchantId = null; if (merchantLink) { const idMatch = merchantLink.match(/member_id=([\\d]+)/); if (idMatch) merchantId = idMatch[1]; else { const pathMatch = merchantLink.match(/\\/(\\d+)\\.htm/); if (pathMatch) merchantId = pathMatch[1]; } } merchants.push({ index: i, merchantId: merchantId, title: title ? title.textContent.trim() : '', merchantName: merchantName ? merchantName.textContent.trim() : '', price: price ? price.textContent.trim() : '', merchantLink: merchantLink, hasImage: !!image, hasContact: !!contactButton, contactInfo: contactButton ? { className: contactButton.className, text: contactButton.textContent.trim(), href: contactButton.href } : null }); console.log(`å•†å®¶ ${i + 1}: ID=${merchantId}, æ ‡é¢˜=${title ? title.textContent.trim().substring(0, 30) : ''}, è”ç³»æ–¹å¼=${contactButton ? 'æ‰¾åˆ°' : 'æœªæ‰¾åˆ°'}`); } const validMerchants = merchants.filter(m => m.merchantId && m.title); const withContact = merchants.filter(m => m.hasContact); console.log(`æœ‰æ•ˆå•†å®¶: ${validMerchants.length}/5`); console.log(`æœ‰è”ç³»æ–¹å¼: ${withContact.length}/5`); return { success: true, type: 'sample_extraction', sampleData: merchants, totalFound: offerItems.length, validMerchants: validMerchants.length, withContact: withContact.length, timestamp: new Date().toISOString() };",
        "saveScreenshots": true
      },
      "next": ["save_results"]
    },
    {
      "id": "save_results",
      "type": "ResultSaverNode",
      "name": "ä¿å­˜éªŒè¯ç»“æœ",
      "config": {
        "outputDir": "archive/workflow-records",
        "filenameTemplate": "1688-selector-verification-{timestamp}.json",
        "includeMetadata": true
      },
      "next": ["end"]
    },
    {
      "id": "end",
      "type": "EndNode",
      "name": "ç»“æŸéªŒè¯",
      "config": { "cleanup": false, "saveLogs": true }
    }
  ],
  "globalConfig": {
    "logLevel": "info",
    "screenshotOnError": true,
    "autoCleanup": false,
    "parallelExecution": false,
    "timeout": 300000
  }
}
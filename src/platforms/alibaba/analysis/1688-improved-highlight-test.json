{
  "name": "1688改进版高亮测试",
  "description": "登录1688并执行改进版发送按钮高亮脚本",
  "version": "1.0.0",
  "preflows": ["1688-login-preflow"],
  "anchor": {
    "hostFilter": "1688.com",
    "selectors": [".userAvatarLogo img"],
    "requireVisible": true,
    "maxWaitMs": 600000,
    "pollIntervalMs": 1500,
    "highlight": true,
    "persistHighlight": true,
    "highlightLabel": "LOGIN_ANCHOR"
  },
  "nodes": [
    { "id": "start", "type": "StartNode", "name": "开始", "next": ["attach"] },
    {
      "id": "attach",
      "type": "AttachSessionNode",
      "name": "会话接力",
      "config": {},
      "next": ["navigate_to_chat"]
    },
    {
      "id": "navigate_to_chat",
      "type": "NavigationNode",
      "name": "导航到1688聊天页面",
      "config": {
        "url": "https://air.1688.com/app/ocms-fusion-components-1688/def_cbu_web_im/index.html",
        "waitUntil": "domcontentloaded",
        "timeout": 30000
      },
      "next": ["wait_chat_load"]
    },
    {
      "id": "wait_chat_load",
      "type": "WaitNode",
      "name": "等待聊天页面加载",
      "config": { "minMs": 5000, "maxMs": 8000 },
      "next": ["execute_improved_highlight"]
    },
    {
      "id": "execute_improved_highlight",
      "type": "JavaScriptExecutionNode",
      "name": "执行改进版高亮脚本",
      "config": {
        "script": "console.log('🎨 开始改进版1688发送按钮高亮...'); const styles = { sendButton: 'border: 5px solid red !important; background: rgba(255, 0, 0, 0.4) !important; box-shadow: 0 0 25px rgba(255, 0, 0, 1) !important; z-index: 10000 !important; position: relative !important; transform: scale(1.05) !important;', inputBox: 'border: 4px solid blue !important; background: rgba(0, 100, 255, 0.3) !important; box-shadow: 0 0 20px rgba(0, 100, 255, 0.8) !important; z-index: 9999 !important; position: relative !important;', container: 'border: 3px solid green !important; background: rgba(0, 255, 0, 0.2) !important; box-shadow: 0 0 15px rgba(0, 255, 0, 0.6) !important; z-index: 9998 !important; position: relative !important;' }; let highlightedCount = 0; document.querySelectorAll('button[style*=\"background-color\"]').forEach((el, index) => { const style = el.getAttribute('style') || ''; if (style.includes('rgb(0, 115, 255)') || style.includes('rgb(0,115,255)')) { el.style.cssText += styles.sendButton; el.setAttribute('data-improved-highlight', 'blue-send-' + index); highlightedCount++; console.log('📤 高亮蓝色发送按钮:', el.className || '(无类名)', el.textContent.trim().substring(0, 20)); } }); document.querySelectorAll('button[class*=\"insight\"], [class*=\"Insight\"]').forEach((el, index) => { if (!el.hasAttribute('data-improved-highlight')) { el.style.cssText += styles.sendButton; el.setAttribute('data-improved-highlight', 'insight-' + index); highlightedCount++; console.log('📤 高亮Insight按钮:', el.className); } }); document.querySelectorAll('textarea').forEach((el, index) => { el.style.cssText += styles.inputBox; el.setAttribute('data-improved-highlight', 'textarea-' + index); highlightedCount++; console.log('📝 高亮输入框:', el.className || '(无类名)'); }); document.querySelectorAll('[class*=\"message\"], [class*=\"chat\"], [class*=\"im\"]').forEach((el, index) => { const rect = el.getBoundingClientRect(); if (rect.width > 100 && rect.height > 50) { el.style.cssText += styles.container; el.setAttribute('data-improved-highlight', 'container-' + index); highlightedCount++; console.log('💬 高亮容器:', el.className); } }); document.querySelectorAll('button, [role=\"button\"], span, div').forEach((el, index) => { if (!el.hasAttribute('data-improved-highlight')) { const text = el.textContent.trim(); if (text.includes('发送') || text.includes('Send')) { el.style.cssText += styles.sendButton; el.setAttribute('data-improved-highlight', 'text-send-' + index); highlightedCount++; console.log('📤 高亮文本发送按钮:', text); } } }); console.log(`\\n🎯 改进版高亮完成！总共高亮了 ${highlightedCount} 个元素`); const infoBox = document.createElement('div'); infoBox.style.cssText = `position: fixed !important; top: 20px !important; right: 20px !important; background: rgba(0, 0, 0, 0.9) !important; color: white !important; padding: 15px !important; border-radius: 8px !important; z-index: 10001 !important; font-size: 14px !important; max-width: 300px !important; font-family: Arial, sans-serif !important;`; infoBox.innerHTML = `<h4 style=\"margin: 0 0 10px 0 !important;\">🎨 1688元素高亮</h4><p style=\"margin: 5px 0 !important;\">📤 红色: 发送按钮</p><p style=\"margin: 5px 0 !important;\">📝 蓝色: 输入框</p><p style=\"margin: 5px 0 !important;\">💬 绿色: 消息容器</p><p style=\"margin: 10px 0 5px 0 !important;\">总计: ${highlightedCount} 个元素</p><small style=\"color: #ccc !important;\">5秒后自动消失</small>`; document.body.appendChild(infoBox); setTimeout(() => { if (infoBox.parentNode) { infoBox.parentNode.removeChild(infoBox); } }, 5000); return { success: true, highlightedCount: highlightedCount, timestamp: new Date().toISOString() };",
        "waitForResult": true
      },
      "next": ["save_result"]
    },
    {
      "id": "save_result",
      "type": "ResultSaverNode",
      "name": "保存高亮结果",
      "config": {
        "outputDir": "archive/workflow-records",
        "filenameTemplate": "1688-improved-highlight-result-{timestamp}.json",
        "includeMetadata": true
      },
      "next": ["end"]
    },
    {
      "id": "end",
      "type": "EndNode",
      "name": "结束",
      "config": { "cleanup": false, "saveLogs": true }
    }
  ],
  "globalConfig": {
    "logLevel": "info",
    "screenshotOnError": true,
    "autoCleanup": false,
    "parallelExecution": false,
    "timeout": 600000
  }
}
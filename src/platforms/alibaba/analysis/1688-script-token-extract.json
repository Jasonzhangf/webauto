{
  "name": "1688 Script Token Extract",
  "description": "接力会话 → 导航搜索页 → 解析 HTML/JS 提取 air.1688.com 动态链接（无需点击）",
  "version": "1.0.0",
  "nodes": [
    { "id": "start", "type": "StartNode", "name": "开始", "next": ["attach"] },
    { "id": "attach", "type": "AttachSessionNode", "name": "会话接力", "config": {}, "next": ["cookies"] },
    { "id": "cookies", "type": "CookieLoaderNode", "name": "加载Cookie", "config": { "cookiePath": "~/.webauto/cookies/1688-domestic.json" }, "next": ["nav"] },
    { "id": "nav", "type": "NavigationNode", "name": "导航搜索页", "config": { "url": "https://s.1688.com/selloffer/offer_search.htm?keywords=%B9%A4%D2%B5%B4%F3%B7%E7%C9%C8&spm=a260k.home2025.searchbox.0", "waitUntil": "domcontentloaded", "timeout": 30000 }, "next": ["wait"] },
    { "id": "wait", "type": "WaitNode", "name": "等待渲染", "config": { "minMs": 1000, "maxMs": 1800 }, "next": ["dismiss"] },
    { "id": "dismiss", "type": "ModalDismissNode", "name": "关闭模态", "config": { "maxAttempts": 5, "retryDelay": 400 }, "next": ["snapshot"] },
    { "id": "snapshot", "type": "PageSnapshotNode", "name": "页面快照", "config": { "maxHtmlLength": 400000, "includeInlineScripts": true, "includeExternalScripts": true, "maxInlineScripts": 40, "maxInlineScriptLength": 20000 }, "next": ["extract"] },
    { "id": "extract", "type": "ScriptTokenExtractorNode", "name": "脚本解析Token", "config": { "hostFilter": "air.1688.com", "maxExternal": 12, "externalAllowHosts": ["alicdn.com", "1688.com"], "timeoutMs": 12000 }, "next": ["save"] },
    { "id": "save", "type": "ResultSaverNode", "name": "保存结果", "config": { "outputDir": "archive/workflow-records", "filenameTemplate": "1688-script-token-{timestamp}.json", "includeMetadata": true }, "next": ["end"] },
    { "id": "end", "type": "EndNode", "name": "结束", "config": { "cleanup": false, "saveLogs": true } }
  ],
  "globalConfig": { "logLevel": "info", "screenshotOnError": true, "autoCleanup": false, "parallelExecution": false, "timeout": 120000 }
}

{
  "name": "1688 Chat Element Highlight",
  "description": "高亮显示1688聊天界面的输入框和发送按钮元素，帮助定位正确的选择器",
  "version": "1.0.0",
  "nodes": [
    { "id": "start", "type": "StartNode", "name": "开始", "next": ["attach"] },
    { "id": "attach", "type": "AttachSessionNode", "name": "会话接力", "config": {}, "next": ["navigate_search"] },
    {
      "id": "navigate_search",
      "type": "NavigationNode",
      "name": "导航到搜索页面",
      "config": {
        "url": "https://s.1688.com/selloffer/offer_search.htm?keywords=%B9%A4%D2%B5%B4%F3%B7%E7%C9%C8&spm=a260k.home2025.searchbox.0",
        "waitUntil": "domcontentloaded",
        "timeout": 30000
      },
      "next": ["wait_search"]
    },
    { "id": "wait_search", "type": "WaitNode", "name": "搜索页面等待", "config": { "minMs": 2000, "maxMs": 3000 }, "next": ["dismiss_modals"] },
    { "id": "dismiss_modals", "type": "ModalDismissNode", "name": "关闭搜索页模态", "config": { "maxAttempts": 4, "retryDelay": 500 }, "next": ["open_chat"] },
    {
      "id": "open_chat",
      "type": "PopupTokenCaptureNode",
      "name": "打开聊天窗口",
      "config": {
        "containerSelector": ".space-pc-ui2024-content > div:nth-child(5)",
        "clickSelectors": ["a.ww-link.ww-inline", "span.J_WangWang a.ww-link", "a[href*=air.1688.com/app/]"],
        "hostFilter": "air.1688.com",
        "maxItems": 1,
        "minClickDelay": 500,
        "maxClickDelay": 1500,
        "afterPopupWaitMs": 2000,
        "closePopup": false,
        "popupClickSelectors": ["body > div:nth-child(23)"],
        "dryMode": false,
        "enforceWebPreference": true,
        "popupStepGate": false
      },
      "next": ["highlight_inputs"]
    },
    {
      "id": "highlight_inputs",
      "type": "GateOverlayNode",
      "name": "高亮输入框元素",
      "config": {
        "targetPopup": true,
        "highlightMode": "sequential",
        "elements": [
          {
            "name": "textarea元素",
            "selectors": ["textarea"],
            "highlightStyle": {
              "border": "3px solid red",
              "backgroundColor": "rgba(255, 0, 0, 0.3)",
              "boxShadow": "0 0 10px red"
            },
            "label": "INPUT - textarea",
            "description": "传统的textarea输入框"
          },
          {
            "name": "contenteditable元素",
            "selectors": ["div[contenteditable='true']", "div[contenteditable]"],
            "highlightStyle": {
              "border": "3px solid blue",
              "backgroundColor": "rgba(0, 0, 255, 0.3)",
              "boxShadow": "0 0 10px blue"
            },
            "label": "INPUT - contenteditable",
            "description": "可编辑的div元素"
          },
          {
            "name": "文本输入框",
            "selectors": ["input[type='text']", "input[type='search']"],
            "highlightStyle": {
              "border": "3px solid green",
              "backgroundColor": "rgba(0, 255, 0, 0.3)",
              "boxShadow": "0 0 10px green"
            },
            "label": "INPUT - text input",
            "description": "文本输入框"
          },
          {
            "name": "隐藏输入框",
            "selectors": ["input[type='hidden']"],
            "highlightStyle": {
              "border": "3px solid orange",
              "backgroundColor": "rgba(255, 165, 0, 0.3)",
              "boxShadow": "0 0 10px orange"
            },
            "label": "INPUT - hidden",
            "description": "隐藏的输入框"
          },
          {
            "name": "通用input元素",
            "selectors": ["input:not([type=hidden])"],
            "highlightStyle": {
              "border": "3px solid purple",
              "backgroundColor": "rgba(128, 0, 128, 0.3)",
              "boxShadow": "0 0 10px purple"
            },
            "label": "INPUT - general",
            "description": "通用输入框"
          }
        ],
        "stepGate": true,
        "gateTitle": "输入框元素定位",
        "gateMessage": "正在高亮显示可能的输入框元素，请查看红色、蓝色、绿色、橙色、紫色边框的元素",
        "showElementInfo": true,
        "autoAdvance": false
      },
      "next": ["highlight_send_buttons"]
    },
    {
      "id": "highlight_send_buttons",
      "type": "GateOverlayNode",
      "name": "高亮发送按钮元素",
      "config": {
        "targetPopup": true,
        "highlightMode": "sequential",
        "elements": [
          {
            "name": "发送按钮(文本)",
            "selectors": ["button:has-text('发送')"],
            "highlightStyle": {
              "border": "3px solid red",
              "backgroundColor": "rgba(255, 0, 0, 0.3)",
              "boxShadow": "0 0 10px red"
            },
            "label": "SEND - 发送按钮",
            "description": "包含'发送'文本的按钮"
          },
          {
            "name": "send-btn类",
            "selectors": [".send-btn", ".btn-send"],
            "highlightStyle": {
              "border": "3px solid blue",
              "backgroundColor": "rgba(0, 0, 255, 0.3)",
              "boxShadow": "0 0 10px blue"
            },
            "label": "SEND - send-btn类",
            "description": "带有send-btn样式的按钮"
          },
          {
            "name": "im-chat-send-btn类",
            "selectors": [".im-chat-send-btn"],
            "highlightStyle": {
              "border": "3px solid green",
              "backgroundColor": "rgba(0, 255, 0, 0.3)",
              "boxShadow": "0 0 10px green"
            },
            "label": "SEND - im-chat-send-btn",
            "description": "IM聊天发送按钮"
          },
          {
            "name": "通用按钮",
            "selectors": ["button", "input[type='button']", "input[type='submit']"],
            "highlightStyle": {
              "border": "3px solid orange",
              "backgroundColor": "rgba(255, 165, 0, 0.3)",
              "boxShadow": "0 0 10px orange"
            },
            "label": "SEND - 通用按钮",
            "description": "所有类型的按钮"
          },
          {
            "name": "包含send的类",
            "selectors": ["[class*='send']", "[class*='Send']"],
            "highlightStyle": {
              "border": "3px solid purple",
              "backgroundColor": "rgba(128, 0, 128, 0.3)",
              "boxShadow": "0 0 10px purple"
            },
            "label": "SEND - send类",
            "description": "包含send的类名元素"
          },
          {
            "name": "聊天相关按钮",
            "selectors": [".chat-send", ".msg-send", ".chat-send-btn"],
            "highlightStyle": {
              "border": "3px solid cyan",
              "backgroundColor": "rgba(0, 255, 255, 0.3)",
              "boxShadow": "0 0 10px cyan"
            },
            "label": "SEND - 聊天按钮",
            "description": "聊天相关的发送按钮"
          }
        ],
        "stepGate": true,
        "gateTitle": "发送按钮元素定位",
        "gateMessage": "正在高亮显示可能的发送按钮元素，请查看各种颜色边框的按钮",
        "showElementInfo": true,
        "autoAdvance": false
      },
      "next": ["highlight_containers"]
    },
    {
      "id": "highlight_containers",
      "type": "GateOverlayNode",
      "name": "高亮容器元素",
      "config": {
        "targetPopup": true,
        "highlightMode": "sequential",
        "elements": [
          {
            "name": "聊天容器",
            "selectors": [".chat-container", ".im-chat", ".message-container"],
            "highlightStyle": {
              "border": "3px solid yellow",
              "backgroundColor": "rgba(255, 255, 0, 0.2)",
              "boxShadow": "0 0 10px yellow"
            },
            "label": "CONTAINER - 聊天容器",
            "description": "聊天界面容器"
          },
          {
            "name": "输入区域",
            "selectors": [".input-area", ".chat-input-area", ".compose-area"],
            "highlightStyle": {
              "border": "3px solid pink",
              "backgroundColor": "rgba(255, 192, 203, 0.3)",
              "boxShadow": "0 0 10px pink"
            },
            "label": "CONTAINER - 输入区域",
            "description": "输入区域容器"
          },
          {
            "name": "编辑器",
            "selectors": [".editor", ".rich-editor", ".chat-editor"],
            "highlightStyle": {
              "border": "3px solid brown",
              "backgroundColor": "rgba(165, 42, 42, 0.3)",
              "boxShadow": "0 0 10px brown"
            },
            "label": "CONTAINER - 编辑器",
            "description": "富文本编辑器"
          }
        ],
        "stepGate": true,
        "gateTitle": "容器元素定位",
        "gateMessage": "正在高亮显示聊天容器和输入区域，请查看黄色、粉色、棕色边框的区域",
        "showElementInfo": true,
        "autoAdvance": false
      },
      "next": ["final_info"]
    },
    {
      "id": "final_info",
      "type": "GateOverlayNode",
      "name": "显示总结信息",
      "config": {
        "targetPopup": true,
        "highlightMode": "info",
        "message": "元素高亮完成！请记录下有效输入框和发送按钮的选择器信息。\n\n输入框优先级：\n1. 红色 - textarea\n2. 蓝色 - contenteditable\n3. 绿色 - text input\n\n发送按钮优先级：\n1. 红色 - '发送'文本按钮\n2. 蓝色 - send-btn类\n3. 绿色 - im-chat-send-btn类\n\n请截图保存高亮结果，然后点击'完成'按钮",
        "stepGate": true,
        "gateTitle": "高亮测试完成",
        "autoAdvance": false
      },
      "next": ["save_results"]
    },
    {
      "id": "save_results",
      "type": "ResultSaverNode",
      "name": "保存测试结果",
      "config": {
        "outputDir": "archive/workflow-records",
        "filenameTemplate": "1688-chat-element-highlight-{timestamp}.json",
        "includeMetadata": true
      },
      "next": ["end"]
    },
    {
      "id": "end",
      "type": "EndNode",
      "name": "结束",
      "config": { "cleanup": false, "saveLogs": true }
    }
  ],
  "globalConfig": {
    "logLevel": "info",
    "screenshotOnError": true,
    "autoCleanup": false,
    "parallelExecution": false,
    "timeout": 600000
  }
}
{
  "version": "1.0.0",
  "operations": [
    { "key": "highlight-green", "label": "高亮(绿色)", "node": "JavaScriptExecutionNode", "params": { "script": "return (function(){ try{ const el=document.querySelector(window.__webautoTmpSelector||''); if(!el) return {ok:false}; window.__webautoHighlight?.createHighlight(el,{color:'#34c759',label:'PICK',duration:4000}); return {ok:true}; }catch(e){ return {ok:false,err:e.message}; } })();" } },
    { "key": "click-dom", "label": "点击(DOM)", "node": "EventDrivenOptionalClickNode", "params": { "click": true, "highlight": true, "maxWaitMs": 8000 } },
    { "key": "copy-selector", "label": "复制选择器", "node": "JavaScriptExecutionNode", "params": { "script": "return (async function(){ try{ const s=window.__webautoTmpSelector||''; await navigator.clipboard?.writeText(s); return {ok:true, selector:s}; }catch(e){ return {ok:false,err:e.message}; } })();" } },

    { "key": "mouse:hover", "label": "鼠标悬停", "node": "JavaScriptExecutionNode", "params": { "script": "return (function(){ try{ const sel=window.__webautoTmpSelector||''; const el=document.querySelector(sel); if(!el) return {ok:false,reason:'no element'}; const r=el.getBoundingClientRect(); const opts={bubbles:true,cancelable:true,clientX:r.left+r.width/2,clientY:r.top+r.height/2}; el.dispatchEvent(new MouseEvent('mouseenter',opts)); el.dispatchEvent(new MouseEvent('mouseover',opts)); el.dispatchEvent(new MouseEvent('mousemove',opts)); return {ok:true}; }catch(e){ return {ok:false,err:e.message}; } })();" } },
    { "key": "mouse:move-center", "label": "鼠标移动到中心(合成)", "node": "JavaScriptExecutionNode", "params": { "script": "return (function(){ try{ const el=document.querySelector(window.__webautoTmpSelector||''); if(!el) return {ok:false,reason:'no element'}; const r=el.getBoundingClientRect(); const opts={bubbles:true,cancelable:true,clientX:r.left+r.width/2,clientY:r.top+r.height/2}; document.dispatchEvent(new MouseEvent('mousemove',opts)); return {ok:true}; }catch(e){ return {ok:false,err:e.message}; } })();" } },

    { "key": "input:set-text", "label": "输入文本(替换)", "node": "JavaScriptExecutionNode", "params": { "script": "return (function(){ try{ const el=document.querySelector(window.__webautoTmpSelector||''); if(!el) return {ok:false,reason:'no element'}; const v=(window.__webautoTmpValue!=null? String(window.__webautoTmpValue):''); el.focus(); if ('value' in el){ el.value=v; el.dispatchEvent(new Event('input',{bubbles:true})); el.dispatchEvent(new Event('change',{bubbles:true})); return {ok:true,value:v}; } return {ok:false,reason:'not input-like'}; }catch(e){ return {ok:false,err:e.message}; } })();" } },
    { "key": "input:append-text", "label": "输入文本(追加)", "node": "JavaScriptExecutionNode", "params": { "script": "return (function(){ try{ const el=document.querySelector(window.__webautoTmpSelector||''); if(!el) return {ok:false,reason:'no element'}; const v=(window.__webautoTmpValue!=null? String(window.__webautoTmpValue):''); if ('value' in el){ el.focus(); el.value = String(el.value||'') + v; el.dispatchEvent(new Event('input',{bubbles:true})); el.dispatchEvent(new Event('change',{bubbles:true})); return {ok:true,value:el.value}; } return {ok:false,reason:'not input-like'}; }catch(e){ return {ok:false,err:e.message}; } })();" } },

    { "key": "extract:text", "label": "提取文字", "node": "JavaScriptExecutionNode", "params": { "script": "return (function(){ try{ const el=document.querySelector(window.__webautoTmpSelector||''); if(!el) return {ok:false,reason:'no element'}; const t=(el.innerText||el.textContent||'').trim(); return {ok:true,text:t,length:t.length}; }catch(e){ return {ok:false,err:e.message}; } })();" } },
    { "key": "extract:html", "label": "提取HTML", "node": "JavaScriptExecutionNode", "params": { "script": "return (function(){ try{ const el=document.querySelector(window.__webautoTmpSelector||''); if(!el) return {ok:false,reason:'no element'}; return {ok:true,html:el.outerHTML}; }catch(e){ return {ok:false,err:e.message}; } })();" } },
    { "key": "extract:attr", "label": "提取属性", "node": "JavaScriptExecutionNode", "params": { "script": "return (function(){ try{ const el=document.querySelector(window.__webautoTmpSelector||''); const name=(window.__webautoTmpValue!=null? String(window.__webautoTmpValue):'href'); if(!el) return {ok:false,reason:'no element'}; return {ok:true,name, value: el.getAttribute(name)}; }catch(e){ return {ok:false,err:e.message}; } })();" } },
    { "key": "extract:links", "label": "提取链接(区域)", "node": "JavaScriptExecutionNode", "params": { "script": "return (function(){ try{ const sel=window.__webautoTmpSelector||''; const root = sel ? document.querySelector(sel) : document.body; if(!root) return {ok:false,reason:'no root'}; const abs=(h)=>{ try{ return new URL(h, location.href).href; }catch{ return h; } }; const set=new Set(); const push=(href)=>{ if(!href) return; const a=abs(href); if(a) set.add(a); }; const anchors = root.querySelectorAll('a[href]'); anchors.forEach(a=>push(a.getAttribute('href'))); if (root.matches && root.matches('a[href]')) push(root.getAttribute('href')); return {ok:true, links: Array.from(set)}; }catch(e){ return {ok:false,err:e.message}; } })();" } }
    ,
    { "key": "keyboard:sequence", "label": "输入+按键序列", "node": "PlaywrightKeySequenceNode", "params": { "keys": ["Enter"], "delay": 30 } }
  ]
}

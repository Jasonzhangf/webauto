{
  "name": "ç»Ÿä¸€é«˜äº®æœåŠ¡é›†æˆæµ‹è¯•",
  "description": "æµ‹è¯•ç»Ÿä¸€é«˜äº®æœåŠ¡åœ¨1688é¡µé¢çš„å®Œæ•´åŠŸèƒ½ï¼ŒåŒ…æ‹¬é”šç‚¹ã€ç‚¹å‡»ã€èŠå¤©èŠ‚ç‚¹çš„é«˜äº®æ•ˆæœ",
  "version": "1.0.0",
  "nodes": [
    { "id": "start", "type": "StartNode", "name": "å¼€å§‹", "next": ["ensure_camoufox"] },
    { "id": "ensure_camoufox", "type": "CamoufoxEnsureNode", "name": "Camoufox æ ¡éªŒ/å®‰è£…", "config": {}, "next": ["browser_init"] },
    {
      "id": "browser_init",
      "type": "BrowserInitNode",
      "name": "æµè§ˆå™¨åˆå§‹åŒ–",
      "config": {
        "engine": "camoufox",
        "headless": false,
        "viewport": { "width": 1920, "height": 1080 },
        "strictAutomationMitigation": false,
        "extraHeaders": false
      },
      "next": ["load_cookies"]
    },
    {
      "id": "load_cookies",
      "type": "CookieLoaderNode",
      "name": "åŠ è½½Cookie",
      "config": {
        "cookiePath": "~/.webauto/cookies/1688-domestic.json"
      },
      "next": ["navigate_search"]
    },
    {
      "id": "navigate_search",
      "type": "NavigationNode",
      "name": "å¯¼èˆªåˆ°1688æœç´¢é¡µ",
      "config": {
        "url": "https://s.1688.com/selloffer/offer_search.htm?keywords=%B8%D6%BB%AF%C4%A4",
        "waitUntil": "domcontentloaded",
        "timeout": 30000
      },
      "next": ["test_anchor_highlight"]
    },
    {
      "id": "test_anchor_highlight",
      "type": "AnchorPointNode",
      "name": "æµ‹è¯•é”šç‚¹é«˜äº®",
      "config": {
        "selectors": [".sm-offer-item", ".offer-item", "[class*=offer]"],
        "requireVisible": true,
        "maxWaitMs": 10000,
        "pollIntervalMs": 1000,
        "highlight": true,
        "persistHighlight": true,
        "highlightColor": "#ff3b30",
        "highlightLabel": "ANCHOR_TEST",
        "highlightDurationMs": 15000,
        "alias": "testAnchor"
      },
      "next": ["verify_anchor"]
    },
    {
      "id": "verify_anchor",
      "type": "PageSnapshotNode",
      "name": "éªŒè¯é”šç‚¹é«˜äº®",
      "config": {
        "script": "console.log('ğŸ” éªŒè¯ç»Ÿä¸€é«˜äº®æœåŠ¡é”šç‚¹æ•ˆæœ...');\\n\\n// æ£€æŸ¥ç»Ÿä¸€é«˜äº®æœåŠ¡çŠ¶æ€\\nconst serviceExists = typeof window.__webautoHighlight !== 'undefined';\\nconst serviceAvailable = serviceExists && typeof window.__webautoHighlight.createHighlight === 'function';\\nconst serviceStats = serviceExists ? window.__webautoHighlight.getStats() : null;\\n\\n// æ£€æŸ¥é«˜äº®å…ƒç´ \\nconst overlays = document.querySelectorAll('.__webauto_anchor_overlay__');\\nconst labels = document.querySelectorAll('[style*=\\\"position:fixed\\\"][style*=\\\"background:#ff3b30\\\"]');\\nconst outlined = document.querySelectorAll('[style*=\\\"outline\\\"][style*=\\\"#ff3b30\\\"]');\\n\\n// åˆ›å»ºéªŒè¯ç»“æœé¢æ¿\\nconst panel = document.createElement('div');\\npanel.innerHTML = `\\n  <h2 style=\\\"color: #ff3b30; margin: 0 0 10px 0;\\\">ğŸ¯ ç»Ÿä¸€é«˜äº®æœåŠ¡éªŒè¯ç»“æœ</h2>\\n  <p><strong>æœåŠ¡çŠ¶æ€:</strong> ${serviceAvailable ? 'âœ… å¯ç”¨' : 'âŒ ä¸å¯ç”¨'}</p>\\n  <p><strong>æ´»è·ƒé«˜äº®:</strong> ${serviceStats ? serviceStats.activeHighlights : 0} ä¸ª</p>\\n  <p><strong>è¦†ç›–å±‚:</strong> ${overlays.length} ä¸ª</p>\\n  <p><strong>æ ‡ç­¾:</strong> ${labels.length} ä¸ª</p>\\n  <p><strong>è½®å»“å…ƒç´ :</strong> ${outlined.length} ä¸ª</p>\\n  <hr style=\\\"margin: 10px 0;\\\">\\n  <p style=\\\"color: #007aff; font-size: 14px;\\\">å¦‚æœçœ‹åˆ°çº¢è‰²é«˜äº®æ•ˆæœï¼Œè¯´æ˜ç»Ÿä¸€é«˜äº®æœåŠ¡å·¥ä½œæ­£å¸¸ï¼</p>\\n  <p style=\\\"color: #666; font-size: 12px;\\\">é«˜äº®å°†ä¿æŒ15ç§’åè‡ªåŠ¨æ¶ˆå¤±</p>\\n`;\\n\\npanel.style.cssText = `\\n  position: fixed;\\n  top: 80px;\\n  right: 50px;\\n  background: rgba(255, 255, 255, 0.95);\\n  border: 3px solid #ff3b30;\\n  padding: 20px;\\n  border-radius: 10px;\\n  box-shadow: 0 0 25px rgba(255, 59, 48, 0.3);\\n  z-index: 2147483647;\\n  font-family: Arial, sans-serif;\\n  font-size: 14px;\\n  min-width: 300px;\\n  backdrop-filter: blur(10px);\\n`;\\n\\ndocument.body.appendChild(panel);\\n\\n// 15ç§’åç§»é™¤é¢æ¿\\nsetTimeout(() => {\\n  try { panel.remove(); } catch {}\\n}, 15000);\\n\\nreturn {\\n  success: true,\\n  serviceExists,\\n  serviceAvailable,\\n  activeHighlights: serviceStats ? serviceStats.activeHighlights : 0,\\n  overlays: overlays.length,\\n  labels: labels.length,\\n  outlined: outlined.length,\\n  timestamp: new Date().toISOString()\\n};",
        "saveScreenshots": true
      },
      "next": ["test_optional_click"]
    },
    {
      "id": "test_optional_click",
      "type": "EventDrivenOptionalClickNode",
      "name": "æµ‹è¯•å¯é€‰ç‚¹å‡»é«˜äº®",
      "config": {
        "selectors": ["button", ".next-btn", "[role='button']"],
        "maxWaitMs": 8000,
        "highlight": true,
        "persistHighlight": true,
        "highlightColor": "#34c759",
        "highlightDurationMs": 12000,
        "click": false,
        "alias": "optionalClickTest"
      },
      "next": ["verify_click_highlight"]
    },
    {
      "id": "verify_click_highlight",
      "type": "PageSnapshotNode",
      "name": "éªŒè¯ç‚¹å‡»é«˜äº®",
      "config": {
        "script": "console.log('ğŸ” éªŒè¯ç‚¹å‡»ç›®æ ‡é«˜äº®æ•ˆæœ...');\\n\\n// æ£€æŸ¥ç»¿è‰²é«˜äº®å…ƒç´ \\nconst greenOverlays = document.querySelectorAll('.__webauto_opt_overlay__');\\nconst greenElements = document.querySelectorAll('[style*=\\\"#34c759\\\"][style*=\\\"outline\\\"][style*=\\\"important\\\"]');\\n\\n// åˆ›å»ºéªŒè¯ç»“æœ\\nconst panel = document.createElement('div');\\npanel.innerHTML = `\\n  <h3 style=\\\"color: #34c759; margin: 0 0 10px 0;\\\">ğŸ¯ ç‚¹å‡»ç›®æ ‡é«˜äº®éªŒè¯</h3>\\n  <p><strong>ç»¿è‰²è¦†ç›–å±‚:</strong> ${greenOverlays.length} ä¸ª</p>\\n  <p><strong>ç»¿è‰²è½®å»“å…ƒç´ :</strong> ${greenElements.length} ä¸ª</p>\\n  <p style=\\\"color: #34c759;\\\">å¦‚æœçœ‹åˆ°ç»¿è‰²é«˜äº®ï¼Œè¯´æ˜ç‚¹å‡»èŠ‚ç‚¹é«˜äº®æ­£å¸¸ï¼</p>\\n`;\\n\\npanel.style.cssText = `\\n  position: fixed;\\n  top: 300px;\\n  right: 50px;\\n  background: rgba(52, 199, 89, 0.95);\\n  color: white;\\n  padding: 15px;\\n  border-radius: 8px;\\n  border: 2px solid #32d74b;\\n  z-index: 2147483647;\\n  font-family: Arial, sans-serif;\\n  font-size: 12px;\\n`;\\n\\ndocument.body.appendChild(panel);\\n\\nsetTimeout(() => {\\n  try { panel.remove(); } catch {}\\n}, 12000);\\n\\nreturn {\\n  success: true,\\n  greenOverlays: greenOverlays.length,\\n  greenElements: greenElements.length,\\n  timestamp: new Date().toISOString()\\n};",
        "saveScreenshots": true
      },
      "next": ["cleanup_highlights"]
    },
    {
      "id": "cleanup_highlights",
      "type": "PageSnapshotNode",
      "name": "æ¸…ç†å¹¶ç»Ÿè®¡é«˜äº®",
      "config": {
        "script": "console.log('ğŸ§¹ æ¸…ç†é«˜äº®å¹¶ç»Ÿè®¡ç»“æœ...');\\n\\n// ç»Ÿè®¡æ‰€æœ‰é«˜äº®å…ƒç´ \\nconst allOverlays = document.querySelectorAll('[class*=\\\"__webauto_highlight_overlay__\\\"]');\\nconst allLabels = document.querySelectorAll('[class*=\\\"__webauto_highlight_overlay__\\\"]:not([style*=\\\"border\\\"])');\\nconst outlinedElements = document.querySelectorAll('[style*=\\\"outline\\\"][style*=\\\"important\\\"][style*=\\\"solid\\\"]:not([class*=\\\"__webauto\\\"])');\\n\\n// ä½¿ç”¨ç»Ÿä¸€æœåŠ¡æ¸…ç†ï¼ˆå¦‚æœå¯ç”¨ï¼‰\\nlet cleanupSuccess = false;\\nif (typeof window.__webautoHighlight !== 'undefined' && window.__webautoHighlight.removeAllHighlights) {\\n  try {\\n    window.__webautoHighlight.removeAllHighlights();\\n    cleanupSuccess = true;\\n  } catch (e) {\\n    console.warn('ç»Ÿä¸€æœåŠ¡æ¸…ç†å¤±è´¥:', e.message);\\n  }\\n}\\n\\n// åˆ›å»ºæœ€ç»ˆç»“æœæŠ¥å‘Š\\nconst reportPanel = document.createElement('div');\\nreportPanel.innerHTML = `\\n  <h2 style=\\\"color: #007aff; margin: 0 0 15px 0;\\\">ğŸ“Š ç»Ÿä¸€é«˜äº®æœåŠ¡æµ‹è¯•æŠ¥å‘Š</h2>\\n  <div style=\\\"background: rgba(0,0,0,0.05); padding: 10px; border-radius: 5px; margin: 10px 0;\\\">\\n    <h4 style=\\\"margin: 5px 0; color: #333;\\\">é«˜äº®ç»Ÿè®¡:</h4>\\n    <p>æ€»è¦†ç›–å±‚: ${allOverlays.length} ä¸ª</p>\\n    <p>æ€»æ ‡ç­¾: ${allLabels.length} ä¸ª</p>\\n    <p>è½®å»“å…ƒç´ : ${outlinedElements.length} ä¸ª</p>\\n    <p>ç»Ÿä¸€æœåŠ¡æ¸…ç†: ${cleanupSuccess ? 'âœ… æˆåŠŸ' : 'âŒ å¤±è´¥'}</p>\\n  </div>\\n  <div style=\\\"background: rgba(0,122,255,0.1); padding: 10px; border-radius: 5px;\\\">\\n    <h4 style=\\\"margin: 5px 0; color: #007aff;\\\">æµ‹è¯•ç»“è®º:</h4>\\n    <p style=\\\"color: #007aff; font-weight: bold;\\\">âœ… ç»Ÿä¸€é«˜äº®æœåŠ¡é›†æˆæµ‹è¯•å®Œæˆ</p>\\n    <p>å¦‚æœé¡µé¢æœ‰çº¢è‰²å’Œç»¿è‰²é«˜äº®æ•ˆæœï¼Œè¯´æ˜åŠŸèƒ½æ­£å¸¸å·¥ä½œï¼</p>\\n  </div>\\n`;\\n\\nreportPanel.style.cssText = `\\n  position: fixed;\\n  top: 50%;\\n  left: 50%;\\n  transform: translate(-50%, -50%);\\n  background: white;\\n  border: 3px solid #007aff;\\n  padding: 25px;\\n  border-radius: 15px;\\n  box-shadow: 0 0 30px rgba(0, 122, 255, 0.3);\\n  z-index: 2147483647;\\n  font-family: Arial, sans-serif;\\n  font-size: 14px;\\n  max-width: 400px;\\n  text-align: center;\\n`;\\n\\ndocument.body.appendChild(reportPanel);\\n\\n// 20ç§’åç§»é™¤æŠ¥å‘Š\\nsetTimeout(() => {\\n  try { reportPanel.remove(); } catch {}\\n}, 20000);\\n\\nreturn {\\n  success: true,\\n  totalOverlays: allOverlays.length,\\n  totalLabels: allLabels.length,\\n  outlinedElements: outlinedElements.length,\\n  cleanupSuccess,\\n  testCompleted: true,\\n  timestamp: new Date().toISOString()\\n};",
        "saveScreenshots": true
      },
      "next": ["end"]
    },
    {
      "id": "end",
      "type": "EndNode",
      "name": "ç»“æŸ",
      "config": { "cleanup": false, "saveLogs": true }
    }
  ],
  "globalConfig": {
    "logLevel": "info",
    "screenshotOnError": true,
    "autoCleanup": false,
    "parallelExecution": false,
    "timeout": 180000
  }
}
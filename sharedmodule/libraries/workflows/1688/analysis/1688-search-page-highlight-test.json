{
  "name": "1688æœç´¢é¡µé¢å•†å®¶å’Œæ—ºæ—ºé“¾æŽ¥é«˜äº®æµ‹è¯•",
  "description": "åœ¨æœç´¢ç»“æžœé¡µé¢é«˜äº®å•†å®¶åˆ—è¡¨å®¹å™¨å’Œå•ä¸ªä¾›åº”å•†çš„æ—ºæ—ºé“¾æŽ¥ï¼Œä¿æŒé«˜äº®ä¾¿äºŽè§‚å¯Ÿ",
  "version": "1.0.0",
  "preflows": ["1688-login-preflow"],
  "nodes": [
    { "id": "start", "type": "StartNode", "name": "å¼€å§‹", "next": ["attach"] },
    {
      "id": "attach",
      "type": "AttachSessionNode",
      "name": "ä¼šè¯æŽ¥åŠ›",
      "config": {},
      "next": ["navigate_search"]
    },
    {
      "id": "navigate_search",
      "type": "NavigationNode",
      "name": "å¯¼èˆªåˆ°æœç´¢ç»“æžœé¡µ",
      "config": {
        "url": "https://s.1688.com/selloffer/offer_search.htm?keywords=%B7%FE%D7%B0",
        "waitUntil": "domcontentloaded",
        "timeout": 30000
      },
      "next": ["wait_search"]
    },
    {
      "id": "wait_search",
      "type": "WaitNode",
      "name": "ç­‰å¾…æœç´¢ç»“æžœå®Œå…¨åŠ è½½",
      "config": { "minMs": 5000, "maxMs": 8000 },
      "next": ["highlight_merchant_containers"]
    },
    {
      "id": "highlight_merchant_containers",
      "type": "PageSnapshotNode",
      "name": "é«˜äº®å•†å®¶åˆ—è¡¨å®¹å™¨",
      "config": {
        "script": "console.log('ðŸ” å¼€å§‹é«˜äº®å•†å®¶åˆ—è¡¨å®¹å™¨...'); const merchantSelectors = ['.sm-offer-item', '.offer-item', '.sm-offer', '[class*=offer]']; let totalHighlighted = 0; merchantSelectors.forEach(selector => { const elements = document.querySelectorAll(selector); if (elements.length > 0) { console.log(`âœ… æ‰¾åˆ°é€‰æ‹©å™¨ ${selector}: ${elements.length} ä¸ªå•†å®¶å®¹å™¨`); elements.forEach((el, index) => { if (index < 10) { el.style.border = '4px solid red'; el.style.backgroundColor = 'rgba(255, 255, 0, 0.4)'; el.style.boxShadow = '0 0 10px red'; el.style.zIndex = '9999'; const title = el.querySelector('h4, [class*=title], a[title]'); const company = el.querySelector('[class*=company], [class*=name], [class*=shop]'); console.log(`  å•†å®¶ ${index + 1}: ${title ? title.textContent.trim().substring(0, 30) : 'æ— æ ‡é¢˜'} - ${company ? company.textContent.trim().substring(0, 20) : 'æ— å…¬å¸å'}`); totalHighlighted++; } }); } else { console.log(`âŒ é€‰æ‹©å™¨ ${selector}: æœªæ‰¾åˆ°å…ƒç´ `); } }); console.log(`æ€»å…±é«˜äº®äº† ${totalHighlighted} ä¸ªå•†å®¶å®¹å™¨`); return { success: true, type: 'merchant_highlight', totalHighlighted: totalHighlighted, message: `å·²é«˜äº® ${totalHighlighted} ä¸ªå•†å®¶å®¹å™¨ï¼Œçº¢è‰²è¾¹æ¡†å’Œé»„è‰²èƒŒæ™¯`, timestamp: new Date().toISOString() };",
        "saveScreenshots": true
      },
      "next": ["highlight_wangwang_links"]
    },
    {
      "id": "highlight_wangwang_links",
      "type": "PageSnapshotNode",
      "name": "é«˜äº®æ—ºæ—ºé“¾æŽ¥",
      "config": {
        "script": "console.log('ðŸ“ž å¼€å§‹é«˜äº®æ—ºæ—ºé“¾æŽ¥...'); const contactSelectors = ['[class*=contact]', '[class*=chat]', '[class*=im]', '[class*=æ—ºæ—º]', '.sm-im', '.s-im']; let totalContactHighlighted = 0; contactSelectors.forEach(selector => { const elements = document.querySelectorAll(selector); if (elements.length > 0) { console.log(`âœ… æ‰¾åˆ°è”ç³»æ–¹å¼é€‰æ‹©å™¨ ${selector}: ${elements.length} ä¸ªå…ƒç´ `); elements.forEach((el, index) => { if (index < 20) { el.style.border = '3px solid blue'; el.style.backgroundColor = 'rgba(0, 255, 255, 0.5)'; el.style.boxShadow = '0 0 8px blue'; el.style.zIndex = '10000'; const merchantItem = el.closest('.sm-offer-item, .offer-item, .sm-offer, [class*=offer]'); const merchantTitle = merchantItem ? merchantItem.querySelector('h4, [class*=title], a[title]') : null; console.log(`  æ—ºæ—ºé“¾æŽ¥ ${index + 1}: ${el.textContent.trim().substring(0, 15)} - å•†å®¶: ${merchantTitle ? merchantTitle.textContent.trim().substring(0, 20) : 'æœªçŸ¥'}`); totalContactHighlighted++; } }); } else { console.log(`âŒ è”ç³»æ–¹å¼é€‰æ‹©å™¨ ${selector}: æœªæ‰¾åˆ°å…ƒç´ `); } }); console.log(`æ€»å…±é«˜äº®äº† ${totalContactHighlighted} ä¸ªæ—ºæ—ºé“¾æŽ¥`); return { success: true, type: 'contact_highlight', totalContactHighlighted: totalContactHighlighted, message: `å·²é«˜äº® ${totalContactHighlighted} ä¸ªæ—ºæ—ºé“¾æŽ¥ï¼Œè“è‰²è¾¹æ¡†å’Œé’è‰²èƒŒæ™¯`, timestamp: new Date().toISOString() };",
        "saveScreenshots": true
      },
      "next": ["keep_highlight_long"]
    },
    {
      "id": "keep_highlight_long",
      "type": "WaitNode",
      "name": "ä¿æŒé«˜äº®30ç§’ä¾¿äºŽè§‚å¯Ÿ",
      "config": { "minMs": 30000, "maxMs": 35000 },
      "next": ["final_verification"]
    },
    {
      "id": "final_verification",
      "type": "PageSnapshotNode",
      "name": "æœ€ç»ˆéªŒè¯é«˜äº®æ•ˆæžœ",
      "config": {
        "script": "console.log('âœ… æœ€ç»ˆéªŒè¯é«˜äº®æ•ˆæžœ...'); const merchantContainers = document.querySelectorAll('[style*=\"border: 4px solid red\"]'); const contactElements = document.querySelectorAll('[style*=\"border: 3px solid blue\"]'); console.log(`éªŒè¯: æ‰¾åˆ° ${merchantContainers.length} ä¸ªé«˜äº®çš„å•†å®¶å®¹å™¨`); console.log(`éªŒè¯: æ‰¾åˆ° ${contactElements.length} ä¸ªé«˜äº®çš„æ—ºæ—ºé“¾æŽ¥`); merchantContainers.forEach((el, i) => { if (i < 5) { const title = el.querySelector('h4, [class*=title], a[title]'); console.log(`å•†å®¶å®¹å™¨ ${i+1}: ${title ? title.textContent.trim().substring(0, 30) : 'æ— æ ‡é¢˜'}`); } }); contactElements.forEach((el, i) => { if (i < 5) { console.log(`æ—ºæ—ºé“¾æŽ¥ ${i+1}: ${el.textContent.trim().substring(0, 20)}`); } }); return { success: true, merchantCount: merchantContainers.length, contactCount: contactElements.length, message: 'é«˜äº®éªŒè¯å®Œæˆï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨ä¸­çš„é«˜äº®æ•ˆæžœ', timestamp: new Date().toISOString() };",
        "saveScreenshots": true
      },
      "next": ["save_results"]
    },
    {
      "id": "save_results",
      "type": "ResultSaverNode",
      "name": "ä¿å­˜é«˜äº®æµ‹è¯•ç»“æžœ",
      "config": {
        "outputDir": "archive/workflow-records",
        "filenameTemplate": "1688-search-page-highlight-{timestamp}.json",
        "includeMetadata": true
      },
      "next": ["end"]
    },
    {
      "id": "end",
      "type": "EndNode",
      "name": "ä¿æŒé¡µé¢æ‰“å¼€ï¼ˆä¸è¦å…³é—­ï¼‰",
      "config": { "cleanup": false, "saveLogs": true }
    }
  ],
  "globalConfig": {
    "logLevel": "info",
    "screenshotOnError": true,
    "autoCleanup": false,
    "parallelExecution": false,
    "timeout": 300000
  }
}